<!doctype html>
<html>

  <head>
    <meta charset="utf-8" />
    <title>Lead Form</title>
  </head>

  <body>
    <h1>Contact</h1>

    <form id="leadForm">
      <input name="name" placeholder="Name" required />
      <br /><br />
      <input name="email" placeholder="Email" required />
      <br /><br />
      <textarea name="message" placeholder="Message" required></textarea>

      <!-- honeypot (hidden) -->
      <input name="companyWebsite" style="display:none" tabindex="-1" autocomplete="off" />

      <br /><br />
      <button type="submit">Send</button>
    </form>

    <pre id="out"></pre>

    <script>
      const form = document.getElementById("leadForm");
      const out = document.getElementById("out");

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        out.textContent = "Sending...";

        const data = Object.fromEntries(new FormData(form).entries());
        console.log("Submitting lead", data);

        try {
          const resp = await fetch("http://localhost:3000/api/leads", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data),
          });

          const json = await resp.json().catch(() => ({}));
          out.textContent = JSON.stringify(json, null, 2);
          if (resp.ok) form.reset();
        } catch (err) {
          console.error("Lead submit failed", err);
          const message = err?.message || String(err);
          out.textContent = `Request failed: ${message}`;
        }
      });
    </script>
  </body>

</html>
